@model MyPass.Models.ViewModels.Vault.LoginItemViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "View Login";
    Layout = "_Layout";
}

<h2>View Login</h2>

<div class="card p-4 shadow-sm" style="max-width: 500px;">
    <h4>@Model.SiteName</h4>

    <!-- USERNAME -->
    <div class="mt-3">
        <label class="fw-bold">Username:</label>
        <div class="input-group">
            <input id="usernameField"
                   type="text"
                   class="form-control"
                   value="@Model.Username"
                   readonly />
            <button type="button"
                    class="btn btn-outline-primary copy-btn"
                    data-value="@Model.Username">
                Copy
            </button>
        </div>
    </div>

    <!-- PASSWORD -->
    <div class="mt-3">
        <label class="fw-bold">Password:</label>
        <div class="input-group">
            <input id="passwordField"
                   type="password"
                   class="form-control"
                   value="@Model.Password"
                   readonly />
            <button type="button"
                    class="btn btn-outline-secondary"
                    id="togglePw">
                <i class="bi bi-eye-slash"></i>
            </button>
            <button type="button"
                    class="btn btn-outline-primary copy-btn"
                    data-value="@Model.Password">
                Copy
            </button>
        </div>
    </div>

    <!-- URL -->
    <div class="mt-3">
        <label class="fw-bold">URL:</label>
        <div class="input-group">
            <input id="urlField"
                   type="text"
                   class="form-control"
                   value="@Model.Url"
                   readonly />
            <button type="button"
                    class="btn btn-outline-primary copy-btn"
                    data-value="@Model.Url">
                Copy
            </button>
        </div>
    </div>

    <a asp-action="Index" class="btn btn-secondary mt-4">Back</a>
</div>

@section Scripts {
    <script>
        // ----- TOGGLE PASSWORD VISIBILITY -----
        const pwField = document.getElementById("passwordField");
        const togglePw = document.getElementById("togglePw");
        const toggleIcon = togglePw.querySelector("i");

        togglePw.addEventListener("click", () => {
            const isHidden = pwField.type === "password";
            pwField.type = isHidden ? "text" : "password";
            toggleIcon.className = isHidden ? "bi bi-eye" : "bi bi-eye-slash";
        });

        // ----- COPY BUTTONS -----
        document.querySelectorAll(".copy-btn").forEach(btn => {
            btn.addEventListener("click", async () => {
                const val = btn.dataset.value || "";
                if (!val) return;

                await navigator.clipboard.writeText(val);

                const original = btn.textContent;
                btn.textContent = "Copied!";
                btn.classList.remove("btn-outline-primary");
                btn.classList.add("btn-success");

                setTimeout(() => {
                    btn.textContent = original;
                    btn.classList.remove("btn-success");
                    btn.classList.add("btn-outline-primary");
                }, 1500);
            });
        });
    </script>
}


