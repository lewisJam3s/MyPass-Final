@model MyPass.Models.ViewModels.Vault.CreditCardViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "View Credit Card";
    Layout = "_Layout";  
}
<h2>View Credit Card</h2>

<div class="card p-4 shadow-sm" style="max-width: 500px;">

    <h4>@Model.CardHolder</h4>

    <div class="mt-3">
        <label class="fw-bold">Card Number:</label>
        <div class="input-group">
            <input id="cardField" type="password" class="form-control" value="@Model.CardNumber" readonly />
            <button class="btn btn-outline-secondary" id="toggleCard"><i class="bi bi-eye-slash"></i></button>
            <button class="btn btn-outline-primary copy-btn" data-value="@Model.CardNumber">Copy</button>
        </div>
    </div>

    <div class="mt-3">
        <label class="fw-bold">CVV:</label>
        <div class="input-group">
            <input id="cvvField" type="password" class="form-control" value="@Model.CVV" readonly />
            <button class="btn btn-outline-secondary" id="toggleCvv"><i class="bi bi-eye-slash"></i></button>
            <button class="btn btn-outline-primary copy-btn" data-value="@Model.CVV">Copy</button>
        </div>
    </div>

    <div class="mt-3">
        <label class="fw-bold">Expiration:</label>
        <p>@Model.ExpMonth / @Model.ExpYear</p>
    </div>

    <a asp-action="Index" class="btn btn-secondary mt-4">Back</a>
</div>

@section Scripts {
    <script>
        function setupToggle(fieldId, btnId) {
            const field = document.getElementById(fieldId);
            const btn = document.getElementById(btnId);
            const icon = btn.querySelector("i");

            btn.addEventListener("click", () => {
                const isHidden = field.type === "password";
                field.type = isHidden ? "text" : "password";
                icon.className = isHidden ? "bi bi-eye" : "bi bi-eye-slash";
            });
        }

        setupToggle("cardField", "toggleCard");
        setupToggle("cvvField", "toggleCvv");

        // Copy support
        document.querySelectorAll(".copy-btn").forEach(btn => {
            btn.addEventListener("click", async () => {
                await navigator.clipboard.writeText(btn.dataset.value);
                const old = btn.textContent;
                btn.textContent = "Copied!";
                btn.classList.replace("btn-outline-primary", "btn-success");

                setTimeout(() => {
                    btn.textContent = old;
                    btn.classList.replace("btn-success", "btn-outline-primary");
                }, 1500);
            });
        });
    </script>
}


